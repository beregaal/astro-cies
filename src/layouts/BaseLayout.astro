---
import SEO from '@components/SEO.astro';
import StructuredData from '@components/StructuredData.astro';
import CiesNavbar from '@components/Navbar.astro';
import CiesFooter from '@components/Footer.astro';

import 'bootstrap/dist/css/bootstrap.min.css';
import 'bootstrap-icons/font/bootstrap-icons.css';
import '@styles/views/form.css';
import '@styles/site.css';

interface BreadcrumbItem {
  name: string;
  url: string;
}

interface FaqItem {
  question: string;
  answer: string;
}

interface CourseData {
  name: string;
  url: string;
  description?: string;
  providerName?: string;
  providerUrl?: string;
}

interface ArticleData {
  headline: string;
  url: string;
  image?: string;
  datePublished?: string;
  dateModified?: string;
  authorName?: string;
}

interface StructuredDataProps {
  organization?: boolean;
  breadcrumbs?: BreadcrumbItem[];
  course?: CourseData;
  faq?: FaqItem[];
  article?: ArticleData;
}

interface Props {
  title?: string;
  description?: string;
  canonical?: string;
  image?: string;
  noIndex?: boolean;
  type?: 'website' | 'article' | 'course';
  structuredData?: StructuredDataProps;
}

const {
  title = 'CiES | Colegio Internacional de Educación Superior',
  description = 'Formación universitaria y de posgrado en psicología, educación y humanidades con RVOE SEP.',
  canonical,
  image,
  noIndex = false,
  type = 'website',
  structuredData
} = Astro.props;
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- SEO -->
    <SEO
      title={title}
      description={description}
      canonical={canonical}
      image={image}
      noIndex={noIndex}
      type={type}
    />

    <!-- Datos estructurados (solo si se mandan) -->
    {structuredData && (
      <StructuredData
        organization={structuredData.organization}
        breadcrumbs={structuredData.breadcrumbs}
        course={structuredData.course}
        faq={structuredData.faq}
        article={structuredData.article}
      />
    )}

    <!-- Favicon PNG principal -->
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png" />
    <!-- Favicon ICO como fallback para navegadores viejos -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <!-- Safari pinned tab (solo para Safari/macOS) -->
    <link rel="mask-icon" href="/favicon.svg" color="#000000" />
    <meta name="generator" content={Astro.generator} />

    <!-- Lightbox CSS -->
    <link rel="stylesheet" href="/vendor/lightbox/css/lightbox.min.css" />
  </head>
  <body class="d-flex flex-column min-vh-100">
    <CiesNavbar />

    <div class="container-fluid flex-grow-1 px-0">
      <main role="main" class="pb-3">
        <slot />
      </main>
    </div>

    <CiesFooter />
    <!-- Bootstrap JS -->
    <script src="/vendor/bootstrap.bundle.min.js" defer></script>
    <!-- Lightbox JS -->
    <script src="/vendor/lightbox/lightbox-plus-jquery.min.js" defer></script>
    <script is:inline>
      document.addEventListener('DOMContentLoaded', function () {
        if (window.lightbox) {
          // @ts-ignore
          window.lightbox.option({
            alwaysShowNavOnTouchDevices: false,
            albumLabel: 'Foto %1 de %2',
            showImageNumberLabel: true,
            positionFromTop: 100,
            resizeDuration: 300,
            wrapAround: true
          });
        }
      });
    </script>
  </body>
</html>
